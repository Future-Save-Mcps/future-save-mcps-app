import{j as e,r as l,a as $e}from"./index-B7suXRWt.js";import{O as je,L as Ee}from"./LoanTabs-nmUOOETs.js";import{B as Le}from"./cardBd-BS66Stox.js";import{h as Ge,c as Re,u as B,i as ze}from"./logo-Dsqscvaz.js";import{D as He,C as w,M as be,d as ve}from"./MenuOpen-DF9EzJu0.js";import{u as Ye,F as m,C as N,a as V}from"./index.esm-DQuZ_ALP.js";import{f as we}from"./formatDate-BNZwrLZe.js";import{g as Ue}from"./weeksOptionGenerator-XSfyeZ1H.js";import{S as k}from"./Spinner-BPxFFULe.js";import{g as Xe,D as _e}from"./react-datepicker-CDo_Haji.js";import{S as Je,F as Ke}from"./Switch-kPbLMUf1.js";import"./formatTimeAgo-CnVqMwlt.js";import"./floating-ui.react-dom-CE18VVHP.js";const Qe="data:image/svg+xml,%3csvg%20width='25'%20height='24'%20viewBox='0%200%2025%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M21.5%2015V19C21.5%2019.5304%2021.2893%2020.0391%2020.9142%2020.4142C20.5391%2020.7893%2020.0304%2021%2019.5%2021H5.5C4.96957%2021%204.46086%2020.7893%204.08579%2020.4142C3.71071%2020.0391%203.5%2019.5304%203.5%2019V15M17.5%208L12.5%203M12.5%203L7.5%208M12.5%203V15'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Ze="/assets/deactivateimg-C24Ic0G4.svg",ea=Ge(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");function aa(t,h){if(typeof t!="number"||typeof h!="number")throw new Error("Both inputs must be numbers");if(h===0)throw new Error("Total cannot be zero");const C=t/h*100;return Math.round(C*100)/100}const Ne={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"95vw",bgcolor:"white",border:"none",outline:"none",p:3,maxWidth:"500px",borderRadius:"20px"},sa=Re(t=>e.jsx(Je,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...t}))(({theme:t})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:"#65C466",opacity:1,border:0}}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:"#E9E9EA",opacity:1,transition:t.transitions.create(["background-color"],{duration:500})}})),fa=()=>{var U,X,_,J,K,Q,Z,ee,ae,se,te,ne,re,le,ie,de,oe,ce,me,xe,ue,pe,he,ge,ye,fe;const t=Xe(),[h,C]=l.useState(!1),[S,ke]=l.useState(null),{data:x,refetch:A,isLoading:$}=B("user/dashboard"),Ce=$e(),{data:s,isLoading:Se,isFetching:Ae,refetch:De}=B(`savingsplan?PlanId=${S}`),{data:u,isLoading:We,refetch:D}=B("savingsplan/all?PageNumber=1&PageSize=10000"),{post:W,isLoading:p}=ze(),{register:c,handleSubmit:F,control:f,setValue:d,watch:j,formState:{errors:r},reset:Fe}=Ye(),E=j("savingsPlan","25"),g=j("paymentType","CurrentWeekPayment"),b=j("Weeks",""),Pe=async a=>{const n={savingsPlanName:a.nameOfSavings,savingsPlan:a.savingsPlan,weeklyAmount:a.weeklyAmount,targetAmount:a.targetAmount,startDate:a.startDate},i=await W("savingsplan",n);i.success&&i.data&&(D(),A(),M())},Me=async a=>{console.log(a);const n={savingsPlanId:S,amount:a.weeklyAmount,paymentType:a.paymentType},i=await W("savingsplan/add-savings-fund",n);i.success&&i.data&&(D(),A(),M())},Te=async a=>{const n={savingsPlanId:S,amount:a.weeklyAmount,loginPassword:a.password},i=await W("savingsplan/withdraw-savings-fund",n);i.success&&i.data&&(D(),De(),A(),O())},[Ie,L]=l.useState(!1),[G,ta]=l.useState(""),[P,Oe]=l.useState(5e3),[qe,na]=l.useState("CurrentWeekPayment"),Be=()=>{L(!0)},M=()=>{L(!1),Fe()},[Ve,R]=l.useState(!1),[v,z]=l.useState("Ongoing"),[y,H]=l.useState(null);l.useEffect(()=>{u&&console.log(u)},[v,u]);const T=(U=u==null?void 0:u.data)==null?void 0:U.items.filter(a=>v==="Ongoing"?a.planStatus==="inProgress":a.planStatus==="completed"),I=a=>{H(a),R(!0)},O=()=>{R(!1),H(null)},q=(a,n=null)=>i=>{i.type==="keydown"&&(i.key==="Tab"||i.key==="Shift")||(ke(n),C(a))};j("weeklyAmount",0);const Y=parseInt(E||0,10);return l.useEffect(()=>{const a=parseInt(P||0,10);d("targetAmount",a*Y)},[E,P]),l.useEffect(()=>{console.log(g==="AdvancePayment"),g==="CurrentWeekPayment"&&d("Weeks",1)},[g,qe]),l.useEffect(()=>{console.log(G),d("weeklyAmount",5e3*b)},[b,G]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-6 mb-8",children:[e.jsxs("div",{className:"min-h-[150px] border gap-4 p-4 flex flex-col justify-center items-center flex-1 rounded-2xl",children:[e.jsxs("div",{className:"font-[400] text-center text-[16px] text-primary",children:["Total Savings"," "]}),e.jsx("div",{className:"font-[700] text-center text-[28px]",children:$?e.jsx(k,{}):e.jsxs(e.Fragment,{children:["₦ ",(_=(X=x==null?void 0:x.data)==null?void 0:X.userDashboard)==null?void 0:_.totalSavingsBalance]})})]}),e.jsxs("div",{className:"min-h-[150px] bg-[#041F620D] gap-4 p-4 flex flex-col justify-center items-center flex-1 rounded-2xl",children:[e.jsx("div",{className:"font-[400] text-center text-[16px] text-primary",children:"Total Savings Dividends"}),e.jsx("div",{className:"font-[700] text-center text-[28px]",children:$?e.jsx(k,{}):e.jsxs(e.Fragment,{children:["₦ ",(K=(J=x==null?void 0:x.data)==null?void 0:J.userDashboard)==null?void 0:K.totalDividendBalance]})})]})]}),e.jsxs("div",{className:" flex items-center  mb-4 justify-between ",children:[e.jsx("h2",{className:"text-[24px] font-[600] ",children:"My Contribution Plans"}),e.jsxs("button",{onClick:Be,className:"bg-primary text-[18px] text-white w-fit px-6 py-2 rounded-lg",children:[" ",e.jsx("span",{className:"font-[600] text-[20px] mr-[15px]",children:"+"})," Create Plan"]})]}),e.jsxs("div",{className:" max-w-[550px] border min-h-[500px] p-4 rounded-2xl ",children:[e.jsxs("div",{className:"flex border-b ",children:[e.jsxs("button",{onClick:()=>z("Ongoing"),className:`flex-1 text-[20px] font-[600] p-4 ${v==="Ongoing"?" border-b-2 border-primary":"text-[#717171]"}`,children:[" ","Ongoing"," "]})," ",e.jsxs("button",{onClick:()=>z("Completed"),className:`flex-1 text-[20px] font-[600] p-4 ${v==="Completed"?" border-b-2 border-primary":"text-[#717171]"}`,children:[" ","Completed"," "]})]}),e.jsx("div",{className:"",children:We?e.jsx(k,{}):T==null?void 0:T.map(a=>e.jsx(je,{id:a.planId,cardTitle:a.planName,contrubutionBalance:`₦ ${a.currentBalance}`,contributionWeekPlan:`${a.durationInWeeks} weeks Plan`,status:a.planStatus,remainingDays:` ${a.daysRemaining} days remaining`,onClick:q(!0,a.planId),percentage:a.planStatus==="completed"?100:aa(a.currentBalance,a.targetAmount)},a.planId))})]})]}),e.jsx(He,{anchor:"right",open:h,children:e.jsxs("div",{className:" w-[100vw] max-w-[700px]",children:[e.jsxs("div",{className:" flex  p-4  bg-white sticky top-0 justify-between mb-8 items-center ",children:[e.jsx("h2",{className:"text-[24px] font-[700]",children:"Plan Details"}),e.jsx(w,{onClick:q(!1),sx:{cursor:"pointer",padding:"5px",width:"35px",height:"35px",borderRadius:"50%",backgroundColor:"#F8F8FA"}})]}),e.jsx("div",{className:"p-4",children:Se||Ae?e.jsx(k,{}):e.jsxs(e.Fragment,{children:[e.jsx(je,{cardTitle:(Q=s==null?void 0:s.data)==null?void 0:Q.planName,contrubutionBalance:`₦ ${(Z=s==null?void 0:s.data)==null?void 0:Z.currentBalance}`,contributionWeekPlan:`${(ee=s==null?void 0:s.data)==null?void 0:ee.durationInWeeks} weeks Plan`,status:(ae=s==null?void 0:s.data)==null?void 0:ae.planStatus,remainingDays:` ${(se=s==null?void 0:s.data)==null?void 0:se.daysRemaining} days remaining`,onClick:q(!0),percentage:((te=s==null?void 0:s.data)==null?void 0:te.planStatus)==="completed"?100:((ne=s==null?void 0:s.data)==null?void 0:ne.currentBalance)<1?0:((re=s==null?void 0:s.data)==null?void 0:re.currentBalance)/((le=s==null?void 0:s.data)==null?void 0:le.targetAmount)*100}),e.jsxs("div",{className:"flex justify-center gap-6 flex-wrap items-center",children:[((ie=s==null?void 0:s.data)==null?void 0:ie.planStatus)==="completed"&&e.jsxs("button",{onClick:()=>I("withdrawFund"),className:"flex my-6 justify-center items-center gap-4 px-6 py-3 rounded-xl text-[#fff] bg-primary ",children:[" ",e.jsx("img",{src:Qe})," Withdraw funds"]}),((de=s==null?void 0:s.data)==null?void 0:de.planStatus)==="inProgress"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>I("addFund"),className:"flex my-6 justify-center items-center gap-4 px-6 py-3 rounded-xl text-[#fff] bg-primary ",children:[" ",e.jsx(ea,{sx:{color:"white"}})," ","Make Repayment"]}),e.jsxs("button",{onClick:()=>I("deactivatePlan"),className:"flex my-6 justify-center items-center gap-4 px-6 py-3 rounded-xl text-[#fff] bg-[#FB0300] ",children:[" ",e.jsx(w,{sx:{color:"white"}})," ","De-activate Plan"]})]})]}),e.jsxs("div",{style:o.card,children:[e.jsxs("div",{style:o.row,children:[e.jsx("div",{style:o.column,children:e.jsxs("div",{className:"w-fit m-auto",children:[e.jsx("p",{children:e.jsx("strong",{children:"Weekly Amount"})}),e.jsxs("p",{children:["NGN ",(oe=s==null?void 0:s.data)==null?void 0:oe.weeklyAmount]})]})}),e.jsx("div",{style:o.column,children:e.jsxs("div",{className:"w-fit m-auto",children:[e.jsx("p",{children:e.jsx("strong",{children:"Target Amount"})}),e.jsxs("p",{children:["NGN ",(ce=s==null?void 0:s.data)==null?void 0:ce.targetAmount]})]})}),e.jsx("div",{style:o.column,children:e.jsxs("div",{className:"w-fit m-auto",children:[e.jsx("p",{children:e.jsx("strong",{children:"Start Date"})}),e.jsx("p",{children:we((me=s==null?void 0:s.data)==null?void 0:me.startDate)})]})})]}),e.jsxs("div",{style:o.row,children:[e.jsx("div",{style:o.column,children:e.jsxs("div",{className:"w-fit m-auto",children:[e.jsx("p",{children:e.jsx("strong",{children:"End Date"})}),e.jsxs("p",{children:[" ",we((xe=s==null?void 0:s.data)==null?void 0:xe.endDate)]})]})}),e.jsx("div",{style:o.column,children:e.jsxs("div",{className:"w-fit m-auto",children:[e.jsx("p",{children:e.jsx("strong",{children:"Dividend"})}),e.jsxs("p",{children:["NGN ",(ue=s==null?void 0:s.data)==null?void 0:ue.dividends]})]})})]})]}),e.jsx(Ee,{transactions:(pe=s==null?void 0:s.data)==null?void 0:pe.transactions,activities:(he=s==null?void 0:s.data)==null?void 0:he.activities})]})})]})}),e.jsx(be,{open:Ie,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(ve,{sx:Ne,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Create Contribution Plan"}),e.jsx(w,{onClick:M,sx:{cursor:"pointer",padding:"5px",width:"35px",height:"35px",borderRadius:"50%",backgroundColor:"#F8F8FA"}})]}),e.jsxs("form",{className:" overflow-auto max-h-[80dvh]",onSubmit:F(Pe),children:[e.jsx(m,{label:"Name of savings",name:"nameOfSavings",type:"text",placeholder:"Detty Easter",register:c,validation:{required:"Name of savings is required"},errors:r}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Savings Plan"}),e.jsx(N,{name:"savingsPlan",control:f,defaultValue:"25",rules:{required:"Savings plan is required"},render:({field:a})=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:`flex items-center space-x-2 flex-1 p-3 rounded-md border ${a.value==="25"?"border-primary":"border-gray-300"}`,children:[e.jsx("input",{...a,type:"radio",value:"25",checked:a.value==="25",className:"w-4 h-4 text-primary border-gray-300 focus:ring-primary"}),e.jsx("span",{children:"25 weeks plan"})]}),e.jsxs("label",{className:`flex items-center space-x-2 flex-1 p-3 rounded-md border ${a.value==="50"?"border-primary":"border-gray-300"}`,children:[e.jsx("input",{...a,type:"radio",value:"50",checked:a.value==="50",className:"w-4 h-4 text-primary border-gray-300 focus:ring-primary"}),e.jsx("span",{children:"50 weeks plan"})]})]})}),r.savingsPlan&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.savingsPlan.message})]}),e.jsx(m,{label:"Weekly Amount (Min. of NGN 5000.00)",name:"weeklyAmount",type:"number",placeholder:"5000",register:c,defaultValueAttachment:5e3,setValue:d,validation:{required:"Weekly amount is required",min:{value:5e3,message:"Amount must be at least NGN 5000.00"}},onchange:!0,setOnChangeValue:Oe,errors:r}),e.jsx(m,{readOnly:!0,defaultValueAttachment:P*Y,setValue:d,label:"Target Amount",name:"targetAmount",type:"number",placeholder:"125000",register:c,validation:{required:"Target amount is required"},errors:r}),e.jsx(N,{name:"startDate",control:f,rules:{required:"Start date is required",validate:a=>new Date(a).getDay()===1||"Please select a Monday."},render:({field:a})=>e.jsx(_e,{...a,selected:a.value,onChange:n=>a.onChange(n),filterDate:n=>n.getDay()===1,dateFormat:"yyyy-MM-dd",placeholderText:"Select a Monday",className:"border border-gray-300 p-2 rounded-md"})}),e.jsxs("div",{className:"mb-4 f",children:[e.jsx("div",{className:"lex items-center",children:e.jsx(N,{name:"terms",control:f,defaultValue:!1,rules:{required:"You must agree to the terms"},render:({field:a})=>e.jsx(Ke,{control:e.jsx(sa,{sx:{margin:"14px"},checked:a.value,onChange:n=>a.onChange(n.target.checked)}),label:e.jsx("span",{style:{fontSize:"12px"},children:"I agree that If I deactivate the savings plan before the due date, I forfeit 50% of my contributions."})})})}),r.terms&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.terms.message})]}),e.jsx(V,{type:"submit",text:"Create Plan",width:"100%",isLoading:p,disabled:p})]})]})}),e.jsx(be,{open:Ve,onClose:O,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(ve,{sx:Ne,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:y==="addFund"?"Add Fund":y==="withdrawFund"?"Withdraw Funds":"Deactivate Plan"}),e.jsx(w,{onClick:O,sx:{cursor:"pointer",padding:"5px",width:"35px",height:"35px",borderRadius:"50%",backgroundColor:"#F8F8FA"}})]}),y==="addFund"&&e.jsxs("form",{className:" overflow-auto max-h-[80dvh]",onSubmit:F(Me),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-primary mb-2",children:"Payment Type"}),e.jsx(N,{name:"paymentType",control:f,defaultValue:"CurrentWeekPayment",rules:{required:"payment type is required"},render:({field:a})=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:`flex items-center space-x-2 flex-1 p-3 rounded-md border ${a.value==="CurrentWeekPayment"?"border-primary":"border-gray-300"}`,children:[e.jsx("input",{...a,type:"radio",value:"CurrentWeekPayment",checked:a.value==="CurrentWeekPayment",className:"w-4 h-4 text-primary border-gray-300 focus:ring-primary"}),e.jsx("span",{children:"This week payment"})]}),e.jsxs("label",{className:`flex items-center space-x-2 flex-1 p-3 rounded-md border ${a.value==="AdvancePayment"?"border-primary":"border-gray-300"}`,children:[e.jsx("input",{...a,type:"radio",value:"AdvancePayment",checked:a.value==="AdvancePayment",className:"w-4 h-4 text-primary border-gray-300 focus:ring-primary"}),e.jsx("span",{children:"Advance Payment"})]})]})}),r.paymentType&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.paymentType.message})]}),g==="AdvancePayment"&&e.jsx(m,{label:"Number of weeks (25 weeks Plan)",name:"Weeks",type:"select",setValue:d,register:c,validation:{required:"Number of weeks is required"},options:Ue(25),errors:r}),e.jsx(m,{label:"Weekly Amount (Your weekly payment is NGN 5000.00)",name:"weeklyAmount",type:"number",big:!0,readOnly:!0,placeholder:"5000",register:c,defaultValueAttachment:b===""||g==="CurrentWeekPayment"?5e3:5e3*b,setValue:d,validation:{required:"Weekly amount is required",min:{value:5e3,message:"Amount must be at least NGN 5000.00"}},errors:r}),e.jsx(V,{width:"100%",type:"submit",text:"Make payment",isLoading:p,disabled:p})]}),y==="withdrawFund"&&e.jsxs("form",{className:" overflow-auto max-h-[80dvh]",onSubmit:F(Te),children:[e.jsx(m,{label:"Total Balance (NGN 2,500.00)",name:"weeklyAmount",type:"number",big:!0,placeholder:"₦ 1000",register:c,defaultValueAttachment:5e3,setValue:d,validation:{required:"Weekly amount is required",min:{value:5e3,message:"Amount must be at least NGN 5000.00"}},errors:r}),e.jsxs("div",{className:"my-6 ",children:[e.jsx("label",{className:"block text-sm font-medium text-[#939393] mb-1",children:"Withdrawal Account"}),e.jsxs("div",{style:{backgroundImage:`url(${Le})`,backgroundColor:"#72109D",backgroundSize:"cover",backgroundRepeat:"repeat",backgroundPosition:"center"},className:" bg-[#72109D] rounded-2xl p-6 flex flex-col justify-center items-center gap-1 ",children:[e.jsx("div",{className:"font-bold text-xl text-white",children:(ge=t==null?void 0:t.data)==null?void 0:ge.bankName}),e.jsx("div",{className:"font-bold text-xl text-white",children:(ye=t==null?void 0:t.data)==null?void 0:ye.bankAccountNumber}),e.jsx("div",{className:"font-bold text-base text-white",children:`(${(fe=t==null?void 0:t.data)==null?void 0:fe.accountName})`})]})]}),e.jsx(m,{label:"Password",name:"password",type:"password",placeholder:"Password",register:c,validation:{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}},errors:r}),e.jsx(V,{width:"100%",type:"submit",text:"Withdraw Funds",isLoading:p,disabled:p})]}),y==="deactivatePlan"&&e.jsxs("div",{className:"flex flex-col gap-4 justify-center items-center",children:[e.jsx("img",{width:"40%",src:Ze,alt:""}),e.jsx("h2",{className:"text-2xl font-semibold",children:"Warning!"}),e.jsxs("p",{className:"w-[70%] text-center text-[#313131] text-base font-semibold",children:["Deactivating funds means that you will lose 50% of this savings balance."," "]}),e.jsxs("div",{className:"flex  w-full justify-center gap-6",children:[e.jsx("button",{onClick:()=>Ce("/user/loan_management"),className:" mt-6 flex-1 justify-center items-center gap-4 px-6 py-3 rounded-xl text-[#fff] bg-primary ",children:"Apply for loan"}),e.jsx("button",{className:" mt-6 flex-1 justify-center items-center gap-4 px-6 py-3 rounded-xl text-[#fff] bg-[#FB0300] ",children:"Deactivate"})]})]})]})})]})},o={card:{margin:"20px auto"},row:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",marginBottom:"15px"},column:{flex:1,padding:"auto",width:"fit-content",margin:"20px 10px"}};export{fa as default};

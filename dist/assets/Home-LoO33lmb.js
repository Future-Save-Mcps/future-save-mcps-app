import{r as d,j as e,t as k,a as C}from"./index-B_aqxHYA.js";import{u as E,F as t,a as A}from"./index.esm-bn0A9YDM.js";import{E as F,s as S,S as U}from"./Constants-CGmaPGOg.js";import{i as B}from"./logo-gHpovZ8O.js";import{a as V}from"./axios-upsvKRUO.js";import{B as q}from"./button-DFE2PDaa.js";import"./utils-CgIokLh3.js";const L=({onNext:c,userId:m})=>{const[i,u]=d.useState([]),[p,N]=d.useState({}),{post:h,isLoading:f}=B(),{register:r,handleSubmit:g,setValue:v,watch:w,formState:{errors:n}}=E();d.useEffect(()=>{(async()=>{try{const x=(await V.get("https://api.paystack.co/bank",{headers:{Authorization:"Bearer YOUR_PAYSTACK_SECRET_KEY"}})).data.data.map(j=>({label:j.name,value:j.code}));u(x)}catch(a){console.error("Error fetching banks:",a)}})()},[]);const l=async o=>{const a={gender:o.gender,bvn:o.bvn,dateOfBirth:o.dateOfBirth,bankAccountNumber:o.accountNumber,accountName:o.accountName,bankName:p.label,bankCode:p.value};console.log("Account Completion Data:",a);const x=await h(`user/${m}/complete-user-profile`,a);x.success&&x.data&&c()};return d.useEffect(()=>{console.log(p)},[p]),e.jsxs("div",{className:"w-full mx-auto",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Account Completion"}),e.jsx("p",{className:"text-gray-600 mb-14",children:"Enter the following information to complete your account."}),e.jsxs("form",{onSubmit:g(l),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsx(t,{label:"Gender",name:"gender",type:"select",setValue:v,register:r,validation:{required:"Gender is required"},options:[{label:"Male",value:"Male"},{label:"Female",value:"Female"}],errors:n}),e.jsx(t,{label:"Date of Birth",name:"dateOfBirth",type:"date",register:r,validation:{required:"Date of birth is required"},placeholder:"DD/MM/YYYY",errors:n}),e.jsx(t,{label:"BVN",name:"bvn",type:"text",register:r,validation:{required:"BVN is required",pattern:{value:/^\d{11}$/,message:"BVN must be 11 digits"}},placeholder:"Enter BVN",errors:n}),e.jsx("div",{children:e.jsx(t,{label:"Bank Name",name:"bankName",type:"Bank",searchable:!0,setValue:v,setBank:N,register:r,validation:{required:"Bank name is required"},options:i,errors:n})}),e.jsx(t,{label:"Name of Account",name:"accountName",type:"text",register:r,validation:{required:"Account name is required"},placeholder:"Enter Name of Account",errors:n}),e.jsx(t,{label:"Account Number",name:"accountNumber",type:"text",register:r,validation:{required:"Account number is required",pattern:{value:/^\d{10}$/,message:"Account number must be 10 digits"}},placeholder:"Enter Account Number",errors:n})]}),e.jsx(A,{type:"submit",text:"Next",isLoading:f,disabled:f})]})]})},Y=()=>{const[c,m]=k(),[i,u]=d.useState(Number(c.get("step"))||1),p=c.get("email")||"",N=c.get("userId")||null,[h,f]=d.useState(null),{post:r,isLoading:g}=B(),v=C(),w=()=>{i===3?v("/",{replace:!0}):u(s=>s+1)},n=async s=>{console.log("Entered OTP:",s);const b=await r("auth/verify-user-email",{userId:N,otp:s});b.success&&b.data&&(m(y=>(y.set("step","3"),y)),w())},{register:l,handleSubmit:o,formState:{errors:a},watch:x}=E(),j=async s=>{const b=await r("auth/register",{firstName:s.firstName,lastName:s.lastName,emailAddress:s.email,password:s.password,role:h,phoneNumber:s.phoneNumber});b.success&&b.data&&(m({step:2,email:s.email,userId:b.data.id}),u(2))},P=x("password");return e.jsx("div",{className:"flex w-[100%]",children:e.jsx("div",{className:"m-auto flex-1 mt-10 px-[10%]",children:e.jsxs("div",{children:[i===1&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-3xl font-semibold mb-4",children:"Sign Up"}),e.jsxs("p",{className:"text-sm mb-[50px]",children:["Already have an account?"," ",e.jsx("a",{href:"/",className:"text-blue-500 font-medium",children:"Login"})]}),!h&&e.jsxs("div",{className:"flex gap-6",children:[e.jsx(q,{onClick:()=>f("Admin"),className:"bg-white flex-1 text-xl border-2 min-h-[200px] rounded-2xl hover:bg-[#dce9f7]  border-primary p-8",children:"Sign Up as an Admin"}),e.jsx(q,{onClick:()=>f("User"),className:"bg-white flex-1 text-xl border-2 min-h-[200px] rounded-2xl hover:bg-[#dce9f7]  border-primary p-8",children:"Sign Up as an User"})]}),h&&e.jsxs("form",{onSubmit:o(j),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsx(t,{label:"First Name",name:"firstName",placeholder:"First Name",register:l,validation:{required:"First Name is required"},errors:a}),e.jsx(t,{label:"Last Name",name:"lastName",placeholder:"Last Name",register:l,validation:{required:"Last Name is required"},errors:a})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsx(t,{label:"Phone Number",name:"phoneNumber",type:"tel",placeholder:"Phone Number",register:l,validation:{required:"Phone Number is required",pattern:{value:/^[0-9]{10,15}$/,message:"Phone number must be between 10-15 digits"}},errors:a}),e.jsx(t,{label:"Email",name:"email",type:"email",placeholder:"Email",register:l,validation:{required:"Email is required",pattern:{value:/^[^@ ]+@[^@ ]+\.[^@ .]{2,}$/,message:"Enter a valid email address"}},errors:a})]}),e.jsx(t,{label:"Password",name:"password",type:"password",placeholder:"Password",register:l,validation:{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}},errors:a}),e.jsx(t,{label:"Confirm Password",name:"confirmPassword",type:"password",placeholder:"Confirm Password",register:l,validation:{required:"Confirm Password is required",validate:s=>s===P||"Passwords do not match"},errors:a}),e.jsx(A,{type:"submit",text:"Next",isLoading:g,disabled:g})]})]}),i===2&&e.jsx(F,{onVerify:n,email:p}),i===3&&e.jsx(L,{onNext:w,userId:N})]})})})},G=()=>{const[c,m]=d.useState(0);return d.useEffect(()=>{const i=setInterval(()=>{m(u=>(u+1)%S.length)},5e3);return()=>clearInterval(i)},[]),e.jsxs("div",{className:"md:flex-row flex-col  flex md:gap-4 h-screen md:p-4",children:[e.jsx("div",{className:"bg-primary text-[#fff] rounded-b-2xl md:rounded-xl flex-[1] flex justify-center items-center",children:e.jsx(U,{currentSlide:c,slides:S})}),e.jsx("div",{className:" flex items-center  overflow-auto flex-[1.5]",children:e.jsx(Y,{})})]})};export{G as default};

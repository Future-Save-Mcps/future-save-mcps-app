import{t as le,a as ce,r,j as t}from"./index-D4psoiX0.js";import{A as me}from"./AdminTableComponent-Brmvcz_Q.js";import{D as xe,C as pe,M as ue,d as fe}from"./MenuOpen-NpkQN4Hi.js";import{S as he}from"./Spinner-CrICQfzk.js";import{O as ge,L as je}from"./LoanTabs-CfvSsPvZ.js";import{u as K}from"./logo-5IldZRap.js";import{f as be}from"./formatDate-BNZwrLZe.js";import{f as a}from"./currencyFormatter-BEPJfsmg.js";import{W as ye}from"./Warning-BRDRpOCK.js";import"./utils-8UP-US0a.js";import"./button-Bi-CEd9d.js";import"./AdminRoutes-CjpW9ION.js";import"./floating-ui.react-dom-CxAUdsKQ.js";import"./index.esm-D9bamS3g.js";import"./dropdown-menu-BN6Bgqvf.js";import"./formatTimeAgo-CnVqMwlt.js";const Ne={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"95vw",bgcolor:"white",border:"none",outline:"none",p:3,maxWidth:"500px",borderRadius:"20px"},He=()=>{var p,u,f,h,g,j,b,y,N,F,v,A,w,S,C,R,L,D,I,B,E,T,k,M,W,$,G,O,Y,z,H,V,_,q,J;const[Q,Fe]=le(),U=ce(),[X,Z]=r.useState(!1),[i,ve]=r.useState(Q.get("id")),[P,o]=r.useState(!1),[d,l]=r.useState(null);r.useEffect(()=>{i&&Z(!0)},[i]);const ee=s=>{window.location.href=`/admin/loan_management?id=${s}`},{data:n,isLoading:c,refetch:Ae}=K("admin/loan/all?PageNumber=1&PageSize=100"),{data:e,isLoading:we,isFetching:te,refetch:Se}=K(`loan?LoanId=${i}`),se=[{label:"Name",value:"fullName"},{label:"Loan Type",value:"loanType"},{label:"Target Amount",value:"totalRepaymentAmount"},{label:"Date Created",value:"userRepaymentStartDate"},{label:"Weekly Amount",value:"weeklyRepaymentAmount"},{label:"Account Status",value:"loanStatus"}],ae=(u=(p=n==null?void 0:n.data)==null?void 0:p.items)==null?void 0:u.map(s=>({...s,id:s.loanApplicationId,userRepaymentStartDate:be(s.userRepaymentStartDate),totalRepaymentAmount:a(s.totalRepaymentAmount),weeklyRepaymentAmount:a(s.weeklyRepaymentAmount),loanStatus:t.jsxs("span",{className:`px-3 py-1 flex w-fit items-center gap-2 rounded-2xl  ${s.loanStatus==="Approved"?"bg-[#34C7591F]  text-[#34C759]":s.loanStatus==="Rejected"?"bg-[#FB03001F]  text-[#FB0300]":"bg-[#FF790C1F]  text-[#FF790C]"}`,children:[t.jsx("div",{className:`w-2 h-2 rounded-full ${s.loanStatus==="Approved"?"bg-[#34C759]":s.loanStatus==="Rejected"?"bg-[#FB0300]":"bg-[#FF790C]"}`})," ",s.loanStatus]})})),m=s=>{o(!0),l(s)},x=()=>{o(!1),l(null)},re=(s,oe)=>{console.log(s)},ie=(s,oe)=>{console.log("this is the filter")},de=()=>{console.log("Exporting data...")},ne=()=>{console.log("Viewing audit trail...")};return t.jsxs("div",{children:[t.jsx(me,{headers:se,data:ae,onSearch:re,onFilter:ie,onExport:de,onAuditTrail:ne,view:ee,loading:c}),t.jsx(xe,{anchor:"right",open:X,children:t.jsxs("div",{className:" w-[100vw] relative max-w-[700px]",children:[t.jsxs("div",{className:" p-4  bg-white  sticky top-0 flex justify-between mb-8 items-center ",children:[t.jsx("h2",{className:"text-[24px] font-[700]",children:"Loan Details "}),t.jsx(pe,{onClick:()=>U(-1),sx:{cursor:"pointer",padding:"5px",width:"35px",height:"35px",borderRadius:"50%",backgroundColor:"#F8F8FA"}})]}),t.jsx("div",{className:"p-4",children:c||te?t.jsx(he,{}):t.jsxs(t.Fragment,{children:[((f=e==null?void 0:e.data)==null?void 0:f.loanStatus)==="PendingApproval"&&t.jsx(ye,{WarningType:"Yellow",text:"You Loan is being processed "}),t.jsx(ge,{percentage:((h=e==null?void 0:e.data)==null?void 0:h.loanStatus)==="completed"?100:(((g=e==null?void 0:e.data)==null?void 0:g.totalRepaymentAmount)-((j=e==null?void 0:e.data)==null?void 0:j.remainingBalance))/((b=e==null?void 0:e.data)==null?void 0:b.totalRepaymentAmount)*100,cardType:"Loan",loanAmount:a((y=e==null?void 0:e.data)==null?void 0:y.totalRepaymentAmount),loanBalance:a((N=e==null?void 0:e.data)==null?void 0:N.remainingBalance),status:(F=e==null?void 0:e.data)==null?void 0:F.loanStatus,cardTitle:(v=e==null?void 0:e.data)==null?void 0:v.loanType,remainingDays:` ${(A=e==null?void 0:e.data)==null?void 0:A.remainingDays} days remaining`}),t.jsxs("div",{className:"flex justify-center flex-wrap gap-4 items-center",children:[((w=e==null?void 0:e.data)==null?void 0:w.isLoanEligibleForAdminApproval)&&((S=e==null?void 0:e.data)==null?void 0:S.isLoanEligibleForAdminApproval)&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>m("Approval"),className:"flex my-6 justify-center min-w-[200px] items-center gap-6 px-6 py-3 rounded-xl text-[#fff] bg-primary ",children:[" ","Approve"]}),t.jsxs("button",{onClick:()=>m("Rejection"),className:"flex my-6 justify-center min-w-[200px] items-center gap-6 px-6 py-3 rounded-xl text-[#fff] bg-[#FB0300] ",children:[" ","Reject"]})]}),((C=e==null?void 0:e.data)==null?void 0:C.loanStatus)==="Approved"?t.jsxs("button",{className:"flex my-6 justify-center p-[8px] min-w-[200px] items-center gap-6  rounded-xl text-[#fff] bg-[#F8F8FA] ",children:[" ",t.jsx("div",{className:"text-[#FF770E] rounded-md px-6 py-1  w-full h-full bg-[#FF770E1A]",children:"In progress"})]}):((R=e==null?void 0:e.data)==null?void 0:R.loanStatus)==="Rejected"?t.jsxs("button",{className:"flex my-6 justify-center p-[8px] min-w-[200px] items-center gap-6  rounded-xl text-[#fff] bg-[#F8F8FA] ",children:[" ",t.jsx("div",{className:"text-[#FB0300] rounded-md px-6 py-1  w-full h-full bg-[#FB030029]",children:"Rejected"})]}):((L=e==null?void 0:e.data)==null?void 0:L.loanStatus)==="Completed"?t.jsxs("button",{className:"flex my-6 justify-center p-[8px] min-w-[200px] items-center gap-6  rounded-xl text-[#fff] bg-[#F8F8FA] ",children:[" ",t.jsx("div",{className:"text-[#34C759] rounded-md px-6 py-1  w-full h-full bg-[#34C75929]",children:"Completed"})]}):((D=e==null?void 0:e.data)==null?void 0:D.loanStatus)==="PendingApproval"?t.jsxs("button",{className:"flex my-6 justify-center p-[8px] min-w-[200px] items-center gap-6  rounded-xl text-[#fff] bg-[#F8F8FA] ",children:[" ",t.jsx("div",{className:"text-[#FF770E] rounded-md px-6 py-1  w-full h-full bg-[#FF770E1A]",children:"In progress"})]}):null]}),t.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Personal Info"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"Name"})," ",(I=e==null?void 0:e.data)==null?void 0:I.fullName]}),t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"Email"})," ",(B=e==null?void 0:e.data)==null?void 0:B.emailAddress]}),t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"Phone No"})," ",(E=e==null?void 0:e.data)==null?void 0:E.phoneNumber]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Plan Info"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"Weekly Repayment"})," ",(T=e==null?void 0:e.data)==null?void 0:T.weeklyRepaymentAmount]}),t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"Target Amount"})," ",a((k=e==null?void 0:e.data)==null?void 0:k.totalRepaymentAmount)]}),t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"Start Date"}),(M=e==null?void 0:e.data)==null?void 0:M.repaymentDurationInMonth]}),t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"End Date"}),(W=e==null?void 0:e.data)==null?void 0:W.endDate]}),t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"Interest Payable"}),a(($=e==null?void 0:e.data)==null?void 0:$.interestAmount)]}),t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"Duration"})," ",(G=e==null?void 0:e.data)==null?void 0:G.repaymentDurationInMonth," Months"]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Guarantors"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"1st Guarantor"})," ",(O=e==null?void 0:e.data)==null?void 0:O.guarantors[0].fullName," (",(Y=e==null?void 0:e.data)==null?void 0:Y.guarantors[0].subscriptionCode,") ",t.jsx("br",{}),"(",(z=e==null?void 0:e.data)==null?void 0:z.guarantors[0].email,")"]}),t.jsxs("p",{className:" flex flex-col",children:[t.jsx("strong",{children:"2nd Guarantor"})," ",(H=e==null?void 0:e.data)==null?void 0:H.guarantors[1].fullName," (",(V=e==null?void 0:e.data)==null?void 0:V.guarantors[1].subscriptionCode,") ",t.jsx("br",{}),"(",(_=e==null?void 0:e.data)==null?void 0:_.guarantors[1].email,")"]})]})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Reason"}),t.jsx("p",{children:(q=e==null?void 0:e.data)==null?void 0:q.loanReason})]})]}),t.jsx(je,{activities:(J=e==null?void 0:e.data)==null?void 0:J.activities})]})})]})}),t.jsx(ue,{open:P,onClose:x,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:t.jsxs(fe,{sx:Ne,children:[t.jsx("div",{className:"flex justify-center items-center mb-4",children:t.jsxs("h2",{className:"text-xl font-semibold",children:["Loan ",d," Confirmation"]})}),t.jsxs("div",{className:"",children:[t.jsxs("p",{className:"text-[#B0B0B0] my-4 text-center",children:["Are you sure you want to"," ",d==="Approval"?"approve":"reject"," this loan?"]}),t.jsxs("div",{className:"flex  gap-4 ",children:[t.jsxs("button",{onClick:x,className:"flex my-6 justify-center flex-1 p-[10px] min-w-[150px] items-center   rounded-md text-[#000] bg-[#F8F8FA] ",children:[" ","No, Iâ€™m not"]}),d==="Approval"?t.jsxs("button",{className:"flex my-6 justify-center flex-1 p-[10px] min-w-[150px] items-center   rounded-md text-[#fff] bg-[#041F62] ",children:[" ","Yes, I am"]}):t.jsxs("button",{className:"flex my-6 justify-center flex-1 p-[10px] min-w-[150px] items-center   rounded-md text-[#fff] bg-[#FB0300] ",children:[" ","Yes, I am"]})]})]})]})})]})};export{He as default};

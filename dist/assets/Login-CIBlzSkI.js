import{j as e,t as V,r as u,a as A,v as O}from"./index-ClRCbON2.js";import{u as x,F as m,a as R}from"./index.esm-MdmZtS2g.js";import{E as j,s as v,S as $}from"./Constants-BRIt--A6.js";import{j as D}from"./logo-Cg91GcYs.js";import{a as y}from"./axios-upsvKRUO.js";const T=({onNext:t})=>{const{register:o,handleSubmit:s,setValue:i,formState:{errors:n}}=x(),d=l=>{console.log("Account Completion Data:",l),t()};return e.jsxs("div",{className:"w-full   mx-auto ",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Forgot Password"}),e.jsx("p",{className:"text-gray-600 mb-14",children:"Enter the email you used in creating an account"}),e.jsxs("form",{onSubmit:s(d),children:[e.jsx("div",{className:"gap-4 mb-6",children:e.jsx(m,{label:"Email",name:"email",type:"email",placeholder:"Email",register:o,validation:{required:"Email is required",pattern:{value:/^[^@ ]+@[^@ ]+\.[^@ .]{2,}$/,message:"Enter a valid email address"}},errors:n})}),e.jsx("button",{type:"submit",className:"w-[150px] mt-8 bg-primary text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition",children:"Continue"})]})]})},k=({onNext:t})=>{const{register:o,handleSubmit:s,setValue:i,formState:{errors:n}}=x(),d=l=>{console.log("Account Completion Data:",l),t()};return e.jsxs("div",{className:"w-full   mx-auto ",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Reset Password"}),e.jsx("p",{className:"text-gray-600 mb-14",children:"Enter new password to reset password"}),e.jsxs("form",{onSubmit:s(d),children:[e.jsxs("div",{className:"gap-4 mb-6",children:[e.jsx(m,{label:"New Password",name:"password",type:"password",placeholder:"Password",register:o,validation:{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}},errors:n}),e.jsx(m,{label:"Confirm Password",name:"confirmPassword",type:"password",placeholder:"Confirm Password",register:o,validation:{required:"Confirm Password is required",validate:l=>l===password||"Passwords do not match"},errors:n})]}),e.jsx("button",{type:"submit",className:"w-[150px] mt-8 bg-primary text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition",children:"Continue"})]})]})},B=()=>{const[t,o]=V(),[s,i]=u.useState(Number(t.get("step"))||1),n=t.get("email")||"",d=t.get("userId")||null;A();const[l,p]=u.useState(!1),{login:N,verifyOtp:P,isInitiateLoading:h,isCompleteLoading:S}=D(),{register:f,handleSubmit:E,formState:{errors:g},watch:b}=x(),w=()=>{i(r=>r+1)},L=async r=>{try{const a=await N({emailAddress:r.email,password:r.password});a.success&&(o({step:2,email:r.email,userId:a.data.userId}),w())}catch(a){console.error("Login error:",a)}},C=async r=>{try{const a=await P(b("email"),r);if(a.success){p(!0);const{accessToken:I}=a.data;y.defaults.headers.common.Authorization=`Bearer ${I}`,y.get(`${O}user`).then(c=>{localStorage.setItem("userInfo",JSON.stringify(c.data)),c.data.data.role==="Admin"?window.location.href="/admin":window.location.href="/user"}).catch(c=>{console.error("API Error:",c)}),p(!1)}}catch(a){console.error("OTP verification error:",a)}},q=r=>{console.log("Entered OTP:",r),alert("Verification successful!"),i(a=>a+1)},F=r=>{alert("reset successful!"),i(1)};return b("password"),e.jsx("div",{className:"flex w-[100%] ",children:e.jsx("div",{className:" m-auto flex-1 mt-10 px-[10%]",children:e.jsxs("div",{children:[s===1&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-3xl font-semibold mb-4",children:"Login"}),e.jsxs("p",{className:"text-sm mb-[50px]",children:["Don't have an account?"," ",e.jsx("a",{href:"/register",className:"text-primary ml-2  font-semibold",children:"Sign Up"})]}),e.jsxs("form",{onSubmit:E(L),children:[e.jsx("div",{className:"grid   gap-4 mb-4",children:e.jsx(m,{label:"Email",name:"email",type:"email",placeholder:"Email",register:f,validation:{required:"Email is required",pattern:{value:/^[^@ ]+@[^@ ]+\.[^@ .]{2,}$/,message:"Enter a valid email address"}},errors:g})}),e.jsx(m,{label:"Password",name:"password",type:"password",placeholder:"Password",register:f,validation:{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}},errors:g}),e.jsxs("p",{className:"text- font-semibold mb-[50px] flex  justify-between",children:[e.jsx("span",{}),e.jsx("p",{onClick:()=>i(3),className:"text-primary font-semibold",children:"Forgot Password?"})]}),e.jsx(R,{type:"submit",text:"Next",isLoading:h,disabled:h})]})]}),s===2&&e.jsx(j,{userId:d,email:n,onVerify:C,isLoading:S||l}),s===3&&e.jsx(T,{onNext:w}),s===4&&e.jsx(j,{onVerify:q}),s===5&&e.jsx(k,{onNext:F})]})})})},K=()=>{const[t,o]=u.useState(0);return u.useEffect(()=>{const s=setInterval(()=>{o(i=>(i+1)%v.length)},5e3);return()=>clearInterval(s)},[]),e.jsxs("div",{className:"md:flex-row flex-col  flex md:gap-4 h-screen md:p-4",children:[e.jsx("div",{className:"bg-primary text-[#fff] rounded-b-2xl md:rounded-xl flex-[1] flex justify-center items-center",children:e.jsx($,{currentSlide:t,slides:v})}),e.jsx("div",{className:" flex items-center  overflow-auto flex-[1.5]",children:e.jsx(B,{})})]})};export{K as default};
